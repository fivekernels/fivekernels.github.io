<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Nextcloud With Docker | èƒ¡å†™ä¹±ç”»</title>
<meta name="keywords" content="nextcloud, docker">
<meta name="description" content="æœ¬æ–‡ä»‹ç»äº†åœ¨æ ‘è“æ´¾(aarch64)ä¸Šä½¿ç”¨dockerçš„æ–¹å¼é…ç½®nextcloud:fpmã€mariadbã€nginxã€redisä»¥åŠonl">
<meta name="author" content="hey">
<link rel="canonical" href="https://fivekernels.github.io/posts/nextcloud-with-docker/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.48143524f6b1c46d7f5b6c3a41ac1b03e87e60ab212cf6c950165c08a1ce50e3.css" integrity="sha256-SBQ1JPaxxG1/W2w6QawbA&#43;h&#43;YKshLPbJUBZcCKHOUOM=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js" integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://fivekernels.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://fivekernels.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://fivekernels.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://fivekernels.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://fivekernels.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Nextcloud With Docker" />
<meta property="og:description" content="æœ¬æ–‡ä»‹ç»äº†åœ¨æ ‘è“æ´¾(aarch64)ä¸Šä½¿ç”¨dockerçš„æ–¹å¼é…ç½®nextcloud:fpmã€mariadbã€nginxã€redisä»¥åŠonl" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://fivekernels.github.io/posts/nextcloud-with-docker/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-20T11:05:07+08:00" />
<meta property="article:modified_time" content="2022-12-20T11:05:07+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Nextcloud With Docker"/>
<meta name="twitter:description" content="æœ¬æ–‡ä»‹ç»äº†åœ¨æ ‘è“æ´¾(aarch64)ä¸Šä½¿ç”¨dockerçš„æ–¹å¼é…ç½®nextcloud:fpmã€mariadbã€nginxã€redisä»¥åŠonl"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "https://fivekernels.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Nextcloud With Docker",
      "item": "https://fivekernels.github.io/posts/nextcloud-with-docker/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Nextcloud With Docker",
  "name": "Nextcloud With Docker",
  "description": "æœ¬æ–‡ä»‹ç»äº†åœ¨æ ‘è“æ´¾(aarch64)ä¸Šä½¿ç”¨dockerçš„æ–¹å¼é…ç½®nextcloud:fpmã€mariadbã€nginxã€redisä»¥åŠonl",
  "keywords": [
    "nextcloud", "docker"
  ],
  "articleBody": "â€ƒæœ¬æ–‡ä»‹ç»äº†åœ¨æ ‘è“æ´¾(aarch64)ä¸Šä½¿ç”¨dockerçš„æ–¹å¼é…ç½®nextcloud:fpmã€mariadbã€nginxã€redisä»¥åŠonlyofficeã€‚\nNextcloudå®˜æ–¹æ‰‹å†Œä¸­æœ‰æ•°æ®åº“ç­‰å„ç§é•œåƒç‰ˆæœ¬æ¨èhttps://docs.nextcloud.com/server/latest/admin_manual/installation/system_requirements.htmlï¼Œæœ€å¥½ä¸è¦ä½¿ç”¨è¿‡äºæ–°çš„ç‰ˆæœ¬ä»¥å…å‡ºç°æœªè¢«è§£å†³çš„å…¼å®¹æ€§é—®é¢˜ã€‚\nNextcloudç‰ˆæœ¬ä»‹ç»ï¼š\nnextcloud:latestï¼šé»˜è®¤æœ€æ–°ç‰ˆæœ¬ï¼Œæ–°æ‰‹å‹å¥½ã€‚ä½¿ç”¨debianå®¹å™¨æ­å»ºï¼Œè‡ªå¸¦apache webæœåŠ¡ï¼Œç‰¹ç‚¹å°±æ˜¯ç®€å•æ–¹ä¾¿ï¼Œä¸€é”®éƒ¨ç½²å°±å¯ä»¥ä½¿ç”¨ï¼Œç¼ºç‚¹å°±æ˜¯åŒ…ç•¥å¤§ã€‚ nextcloud:fpmï¼šåœ¨debianå®¹å™¨çš„åŸºç¡€ä¸Šä¸å¸¦apache webæœåŠ¡ï¼Œéœ€è¦é…å¥—webç¨‹åºæ‰èƒ½ä½¿ç”¨ï¼Œå¦‚NGINXã€‚ nextcloud:-alpineï¼šä½¿ç”¨alpineä½œä¸ºå®¹å™¨ï¼Œç©ºé—´å æ®å°‘ï¼Œé€‚åˆå°ä¸»æœºä½¿ç”¨ã€‚ docker-compose docker-compose.yml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 version: '3' services: nextcloud: hostname: nextcloud image: nextcloud:fpm container_name: nextcloud_nextcloud restart: unless-stopped volumes: - ./PersistentData/nextcloud:/var/www/html env_file: - ./nextcloud.env depends_on: - mariadb - redis mariadb: hostname: mariadb image: mariadb container_name: nextcloud_mariadb restart: unless-stopped command: --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --transaction-isolation=READ-COMMITTED --binlog-format=ROW --innodb_read_only_compressed=OFF volumes: - ./PersistentData/mariadb:/var/lib/mysql env_file: - ./mariadb.env nginx: hostname: nginx image: nginx container_name: nextcloud_nginx restart: unless-stopped volumes: - ./config/nginx/nginx.conf:/etc/nginx/nginx.conf:ro - ./config/ssl//fullchain.pem:/etc/ssl/nginx/fullchain.pem - ./config/ssl//privkey.pem:/etc/ssl/nginx/privkey.pem - ./PersistentData/nextcloud:/usr/share/nginx/html/nextcloud:ro ports: - \"80:80\" - \"443:443\" depends_on: - nextcloud redis: image: redis container_name: nextcloud_redis restart: unless-stopped cron: image: nextcloud:fpm container_name: nextcloud_cron restart: unless-stopped volumes: - ./PersistentData/nextcloud:/var/www/html entrypoint: /cron.sh depends_on: - mariadb - redis nextcloud.env 1 2 3 4 5 6 7 8 9 10 11 NEXTCLOUD_ADMIN_USER= NEXTCLOUD_ADMIN_PASSWORD= NEXTCLOUD_TRUSTED_DOMAINS= MYSQL_HOST=mariadb MYSQL_DATABASE= MYSQL_USER= MYSQL_PASSWORD= REDIS_HOST=redis REDIS_HOST_PORT=6379 mariadb.env 1 2 3 4 5 MARIADB_ROOT_PASSWORD= MARIADB_DATABASE= MARIADB_USER= MARIADB_PASSWORD= MARIADB_AUTO_UPGRADE=1 docker-composeæ–‡ä»¶è§£æ åœ¨Nextcloudçš„å®˜æ–¹dockeré¡µé¢https://hub.docker.com/_/nextcloud æœ‰docker-composeçš„ç¤ºä¾‹é…ç½®æ–‡ä»¶\nnextcloud-fpm Nextcloudä¸­æ‰€æœ‰çš„æ•°æ®æ–‡ä»¶å­˜æ”¾åœ¨å®¹å™¨å†…çš„/var/www/htmlä¸­ï¼Œå¯ä»¥å°†å…¶æ˜ å°„åˆ°å¤–éƒ¨å­˜å‚¨ã€‚dataå’Œconfigæ–‡ä»¶å­˜å‚¨åœ¨å…¶ä¸­å•ç‹¬çš„æ–‡ä»¶å¤¹ï¼Œappsæ–‡ä»¶å¤¹æ˜¯éšç€nextcloudä¸€èµ·æä¾›çš„ï¼Œæ— éœ€åœ¨æ„ã€‚\nä½¿ç”¨ç¯å¢ƒå˜é‡å¯ä»¥ç¬¬ä¸€æ¬¡å®‰è£…æ—¶è‡ªåŠ¨é…ç½®ç›¸å…³è®¾ç½®ï¼Œä»¥ä½¿ç”¨MariaDB/MYSQLä¸ºä¾‹ï¼Œé…ç½®æ•°æ®åº“éœ€è¦è®¾ç½®ä»¥ä¸‹å‡ ä¸ªç¯å¢ƒå˜é‡ï¼š\nMYSQL_HOST: Hostname of the database server using mysql / mariadb. MYSQL_DATABASE: Name of the database using mysql / mariadb. MYSQL_USER: Username for the database using mysql / mariadb. MYSQL_PASSWORD: Password for the database user using mysql / mariadb. è®¾ç½®å¦‚ä¸‹ç¯å¢ƒå˜é‡å¯ä»¥åœ¨å®‰è£…nextcloudæ—¶è‡ªåŠ¨é…ç½®ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ï¼š\nNEXTCLOUD_ADMIN_USER: Name of the Nextcloud admin user. NEXTCLOUD_ADMIN_PASSWORD: Password for the Nextcloud admin user. è®¾ç½®å¦‚ä¸‹ç¯å¢ƒå˜é‡å¯ä»¥åœ¨å®‰è£…æ—¶è‡ªåŠ¨æ·»åŠ å¯ä¿¡åŸŸåï¼š\nNEXTCLOUD_TRUSTED_DOMAINS: (not set by default) Optional space-separated list of domains å¦‚æœä½¿ç”¨äº†redisï¼ˆæ¨èï¼‰ï¼Œè¿˜åº”æ·»åŠ ä¸‹åˆ—å˜é‡æŒ‡å‡ºredisæœåŠ¡å™¨ä¿¡æ¯ï¼š\nREDIS_HOST (not set by default) Name of Redis container REDIS_HOST_PORT (default: 6379) Optional port for Redis, only use for external Redis servers that run on non-standard ports. REDIS_HOST_PASSWORD (not set by default) Redis password PHPç›¸å…³é™åˆ¶ï¼šï¼ˆæœªæµ‹è¯•ï¼‰\nPHP_MEMORY_LIMIT: (default 512M) This sets the maximum amount of memory in bytes that a script is allowed to allocate. This is meant to help prevent poorly written scripts from eating up all available memory but it can prevent normal operation if set too tight. PHP_UPLOAD_LIMIT: (default 512M) This sets the upload limit (post_max_size and upload_max_filesize) for big files. Note that you may have to change other limits depending on your client, webserver or operating system. Check the Nextcloud documentation for more information. å½“ç„¶ï¼Œå¯ä»¥ä½¿ç”¨_FILEæ›¿ä»£ç›´æ¥åœ¨docke-composeè®¾ç½®ç¯å¢ƒå˜é‡ä»¥ä¼ é€’æ•æ„Ÿä¿¡æ¯ã€‚æˆ‘æ²¡ä»”ç»†çœ‹https://hub.docker.com/_/nextcloud\nmariadb mariadbçš„æ•°æ®åº“æ–‡ä»¶ä½äºå®¹å™¨å†…çš„/var/lib/mysqlï¼Œå¯ä»¥å°†å…¶æ˜ å°„åˆ°å®¹å™¨å¤–éƒ¨ã€‚\nå½“ä½¿ç”¨dockeråˆ›å»ºæ–°æ•°æ®åº“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç¯å¢ƒå˜é‡æ¥è°ƒæ•´MariaDBçš„åˆå§‹åŒ–ï¼Œä»10.5.10å’Œ10.6å¼€å§‹ä»¥åçš„æ‰€æœ‰ç‰ˆæœ¬ä¸­ï¼ŒMARIADB_* å’Œ MYSQL_* å…·æœ‰ç­‰æ•ˆçš„åŠŸèƒ½ï¼Œä¸”MARIADB_*å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚\nä¸‹åˆ—å››ä¸ªç¯å¢ƒå˜é‡(or equivalents, including *_FILE)å¿…é¡»è®¾å®šä¸€ä¸ªï¼Œä»¥ç¡®å®šroogç”¨æˆ·å¯†ç ï¼š\nMARIADB_ROOT_PASSWORD: This specifies the password that will be set for the MariaDB root superuser account. MARIADB_ROOT_PASSWORD_HASH: In order to have no plaintext secret in the deployment, MARIADB_ROOT_PASSWORD_HASH can be used as it is just the hash of the password. The hash can be generated with SELECT PASSWORD(â€™thepasswordâ€™) as a SQL query. MARIADB_RANDOM_ROOT_PASSWORD: Set to a non-empty value, like yes, to generate a random initial password for the root user. The generated root password will be printed to stdout (GENERATED ROOT PASSWORD: â€¦..). MARIADB_ALLOW_EMPTY_ROOT_PASSWORD: Set to a non-empty value, like yes, to allow the container to be started with a blank password for the root user. å…¶ä»–çš„ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰ï¼š\nMARIADB_DATABASE: This variable allows you to specify the name of a database to be created on image startup. MARIADB_USER: These are used in conjunction to create a new user and to set that userâ€™s password. This user will be granted all access (corresponding to GRANT ALL) to the MARIADB_DATABASE database. MARIADB_PASSWORD: Both user and password variables are required for a user to be created. MARIADB_PASSWORD_HASH: See MARIADB_ROOT_PASSWORD_HASH above for how to get a password hash for MARIADB_PASSWORD_HASH. MARIADB_AUTO_UPGRADE: Set MARIADB_AUTO_UPGRADE to a non-empty value to have the entrypoint check whether mysql_upgrade/mariadb-upgrade needs to run, and if so, run the upgrade before starting the MariaDB server. MARIADB_DISABLE_UPGRADE_BACKUP: Before the upgrade, a backup of the system database is created in the top of the datadir with the name system_mysql_backup_*.sql.zst. This backup process can be disabled with by setting MARIADB_DISABLE_UPGRADE_BACKUP to a non-empty value. nginx ç¼–å†™é…ç½®æ–‡ä»¶nginx.confå¹¶æ˜ å°„åˆ°å®¹å™¨å†…çš„/etc/nginx/nginx.confï¼Œä½œä¸ºé…ç½®æ–‡ä»¶ï¼›åŒæ—¶è¿˜éœ€è¦æŠŠnextcloudä¸­çš„/var/www/htmlæ˜ å°„åˆ°nginxå®¹å™¨å†…éƒ¨ï¼Œä½œä¸ºç½‘ç«™å†…å®¹ã€‚\nredis cron å®˜æ–¹æ–‡æ¡£ä¸­å…³äºbackground jonsçš„ä»‹ç»ï¼šhttps://docs.nextcloud.com/server/latest/admin_manual/configuration_server/background_jobs_configuration.html\nä½¿ç”¨dockeréƒ¨ç½²cronæ—¶ï¼Œcronçš„è¿è¡Œéœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨å¹¶å’Œnextcloudå…±äº«æ•°æ®æ–‡ä»¶ï¼Œå¹¶ä¸”æ®è¯´æ‰€å ç”¨çš„å†…å­˜å¾ˆå°‘ï¼Œä¸ä¼šä¸ºä¸»æœºå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼›å¯ä»¥å‚è€ƒå®˜æ–¹ç¤ºä¾‹ä¸­ä½¿ç”¨docker-composeè¿è¡Œcronçš„é…ç½®æ–‡ä»¶ï¼šhttps://github.com/nextcloud/docker/blob/master/.examples/docker-compose/insecure/mariadb/apache/docker-compose.ymlã€‚\næ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸»æœºçš„cronå¹¶æ­é…docker execå‘½ä»¤å®ç°å®šæ—¶çš„åå°ä»»åŠ¡ã€‚\næ›´æ–°nextcloudç‰ˆæœ¬ å½“ä½¿ç”¨ docker-compose æ—¶ï¼Œæ›´æ–°å®¹å™¨çš„æ–°ç‰ˆæœ¬åªéœ€è¦è¿è¡Œ:\n1 2 docker-compose pull docker-compose up -d ä½†æ˜¯ä¸èƒ½è·¨è¶Šå¤šä¸ªå¤§ç‰ˆæœ¬å‡çº§ï¼Œæ­¤æ—¶éœ€è¦ä¿®æ”¹nextcloud:-fpmæŒ‡å®šå¤§ç‰ˆæœ¬å·è¿›è¡Œä»¥æ­¤å‡çº§ã€‚\nnextcloud é…ç½®æ–‡ä»¶ nextcloud æ”¯æŒä½¿ç”¨å¤šä¸ªconfig.phpé…ç½®æ–‡ä»¶ï¼›å¯ä»¥åœ¨/var/www/html/config/è·¯å¾„ä¸‹æ”¾ç½®*.config.phpæ–‡ä»¶å®ç°å¯¹nextcloudçš„é…ç½®ï¼Œä¸”è¿™äº›æ–‡ä»¶ä¸­é…ç½®çš„å‚æ•°ä¼˜å…ˆçº§é«˜äºconfig.phpä¸­çš„è®¾å®šã€‚\n1 2 3 4 5 6 \u003c?php $CONFIG = array ( 'remember_login_cookie_lifetime' =\u003e 0, 'default_phone_region' =\u003e 'CN', 'defaultapp' =\u003e 'calendar,files,dashboard', ); remember_login_cookie_lifetime è®°ä½ç™»å½• cookie çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸º0åˆ™å…³é—­æµè§ˆå™¨åcookieç«‹å³å¤±æ•ˆã€‚\ndefault_phone_region ä½¿ç”¨ ISO 3166-1 å›½å®¶ä»£ç ä¸º Nextcloud æœåŠ¡å™¨ä¸Šçš„ç”µè¯å·ç è®¾ç½®é»˜è®¤åŒºåŸŸã€‚\ndefaultapp è®¾ç½®ç”¨æˆ·ç™»å½•åé¦–å…ˆè¿›å…¥çš„åº”ç”¨ï¼›å‚æ•°ä¸ºåœ¨ç‚¹å‡»Nextcloudé¡¶éƒ¨çš„â€œåº”ç”¨ç¨‹åºâ€èœå•åï¼Œå¯¹åº”çš„URLåç§°ï¼Œå¦‚ documentsï¼Œcalendarï¼Œgalleryç­‰ã€‚å¯ä»¥ä½¿ç”¨\",â€œåˆ†éš”åº”ç”¨åˆ—è¡¨ã€‚è®¾ç½®å¤šä¸ªåº”ç”¨åç§°æ—¶ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¿›å…¥åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆå¦‚åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªåº”ç”¨æ²¡å¯ç”¨ï¼‰ï¼Œåˆ™ Nextcloud å°†å°è¯•ä½¿ç”¨æˆ·è¿›å…¥ç¬¬äºŒä¸ªåº”ç”¨ç¨‹åºï¼Œä¾æ­¤ç±»æ¨ã€‚å¦‚æœ Nextcloud æ²¡æœ‰æ‰¾åˆ°å·²å¯ç”¨çš„åº”ç”¨ç¨‹åºï¼Œåˆ™é»˜è®¤ä¸ºä»ªè¡¨æ¿åº”ç”¨ç¨‹åºã€‚\nnginx é…ç½®æ–‡ä»¶ nginx.conf 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 worker_processes auto; error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime.types; default_type application/octet-stream; log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' '$status $body_bytes_sent \"$http_referer\" ' '\"$http_user_agent\" \"$http_x_forwarded_for\"'; access_log /var/log/nginx/access.log main; sendfile on; #tcp_nopush on; keepalive_timeout 65; #gzip on; upstream php-handler { server nextcloud:9000; } server { listen 80; listen [::]:80; #server_name nextcloud.example.com; server_name \u003cexample.domain\u003e; return 301 https://$server_name$request_uri; } server { listen 443 ssl http2; listen [::]:443 ssl http2; #server_name nextcloud.example.com; server_name \u003cexample.domain\u003e; error_page 497 =301 https://$http_host$request_uri; ssl_certificate /etc/ssl/nginx/fullchain.pem; ssl_certificate_key /etc/ssl/nginx/privkey.pem; ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256; ssl_prefer_server_ciphers on; ssl_ecdh_curve secp384r1; # HSTS settings # WARNING: Only add the preload option once you read about # the consequences in https://hstspreload.org/. This option # will add the domain to a hardcoded list that is shipped # in all major browsers and getting removed from this list # could take several months. add_header Strict-Transport-Security \"max-age=15768000; includeSubDomains; preload;\" always; # set max upload size client_max_body_size 100G; fastcgi_buffers 64 4K; fastcgi_send_timeout 300s; fastcgi_read_timeout 300s; # Enable gzip but do not remove ETag headers gzip on; gzip_vary on; gzip_comp_level 4; gzip_min_length 256; gzip_proxied expired no-cache no-store private no_last_modified no_etag auth; gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy; # Pagespeed is not supported by Nextcloud, so if your server is built # with the `ngx_pagespeed` module, uncomment this line to disable it. #pagespeed off; # HTTP response headers borrowed from Nextcloud `.htaccess` add_header Referrer-Policy \"no-referrer\" always; add_header X-Content-Type-Options \"nosniff\" always; add_header X-Download-Options \"noopen\" always; add_header X-Frame-Options \"SAMEORIGIN\" always; add_header X-Permitted-Cross-Domain-Policies \"none\" always; add_header X-Robots-Tag \"none\" always; add_header X-XSS-Protection \"1; mode=block\" always; # Remove X-Powered-By, which is an information leak fastcgi_hide_header X-Powered-By; # Path to the root of your installation root /usr/share/nginx/html/nextcloud; # Specify how to handle directories -- specifying `/index.php$request_uri` # here as the fallback means that Nginx always exhibits the desired behaviour # when a client requests a path that corresponds to a directory that exists # on the server. In particular, if that directory contains an index.php file, # that file is correctly served; if it doesn't, then the request is passed to # the front-end controller. This consistent behaviour means that we don't need # to specify custom rules for certain paths (e.g. images and other assets, # `/updater`, `/ocm-provider`, `/ocs-provider`), and thus # `try_files $uri $uri/ /index.php$request_uri` # always provides the desired behaviour. index index.php index.html /index.php$request_uri; # Rule borrowed from `.htaccess` to handle Microsoft DAV clients location = / { if ( $http_user_agent ~ ^DavClnt ) { return 302 /remote.php/webdav/$is_args$args; } } location = /robots.txt { allow all; log_not_found off; access_log off; } # Make a regex exception for `/.well-known` so that clients can still # access it despite the existence of the regex rule # `location ~ /(\\.|autotest|...)` which would otherwise handle requests # for `/.well-known`. location ^~ /.well-known { # The rules in this block are an adaptation of the rules # in `.htaccess` that concern `/.well-known`. location = /.well-known/carddav { return 301 $scheme://$http_host/remote.php/dav/; } location = /.well-known/caldav { return 301 $scheme://$http_host/remote.php/dav/; } location /.well-known/acme-challenge { try_files $uri $uri/ =404; } location /.well-known/pki-validation { try_files $uri $uri/ =404; } # Let Nextcloud's API for `/.well-known` URIs handle all other # requests by passing them to the front-end controller. return 301 $scheme://$http_host/index.php$request_uri; } # Rules borrowed from `.htaccess` to hide certain paths from clients location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)(?:$|/) { return 404; } location ~ ^/(?:\\.|autotest|occ|issue|indie|db_|console) { return 404; } # Ensure this block, which passes PHP files to the PHP process, is above the blocks # which handle static assets (as seen below). If this block is not declared first, # then Nginx will encounter an infinite rewriting loop when it prepends `/index.php` # to the URI, resulting in a HTTP 500 error response. location ~ \\.php(?:$|/) { fastcgi_split_path_info ^(.+?\\.php)(/.*)$; set $path_info $fastcgi_path_info; try_files $fastcgi_script_name =404; include fastcgi_params; # fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name; fastcgi_param PATH_INFO $path_info; #fastcgi_param HTTPS on; fastcgi_param modHeadersAvailable true; # Avoid sending the security headers twice fastcgi_param front_controller_active true; # Enable pretty urls fastcgi_pass php-handler; fastcgi_intercept_errors on; fastcgi_request_buffering off; } location ~ \\.(?:css|js|svg|gif)$ { try_files $uri /index.php$request_uri; expires 6M; # Cache-Control policy borrowed from `.htaccess` access_log off; # Optional: Don't log access to assets } location ~ \\.woff2?$ { try_files $uri /index.php$request_uri; expires 7d; # Cache-Control policy borrowed from `.htaccess` access_log off; # Optional: Don't log access to assets } # Rule borrowed from `.htaccess` location /remote { return 301 /remote.php$request_uri; } location / { try_files $uri $uri/ /index.php$request_uri; } } } root /usr/share/nginx/html/nextcloud; è®¾ç½®äº†ç½‘ç«™çš„æ ¹ç›®å½•ä½ç½®ï¼›éœ€è¦é€šè¿‡docker-composeæŠŠnextcloudä¸­çš„/var/www/htmlæ˜ å°„åˆ° root â€¦ è®¾ç½®çš„è·¯å¾„ä¸‹ã€‚\nfastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name; ç”¨æ¥é…ç½®fastcgiä¼ é€’nginxåˆ°php-fpmçš„ä¿¡æ¯ï¼Œ/var/www/html éœ€è¦è®¾å®šä¸ºnextcloudå®¹å™¨ä¸­ç½‘ç«™çš„è·¯å¾„ï¼›è‹¥nginxä¸­çš„ç½‘ç«™è·¯å¾„ä½¿ç”¨ root â€¦ è®¾å®šä¸ºä¸nextcloudä¸­è·¯å¾„ç›¸åŒ(/var/www/html)ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ $document_root ä»£æ›¿ /var/www/htmlã€‚\nMariaDB 10.6å…¼å®¹æ€§é—®é¢˜ nextcloud25å·²æ— æ­¤é—®é¢˜ã€‚\nnextcloud22å’Œmariadb10.6æœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œå¯¹docker-composeæ–‡ä»¶ä¸­mariadbçš„commandæ·»åŠ â€“innodb_read_only_compressed=OFFå¯æš‚æ—¶è§£å†³ã€‚\nhttps://github.com/nextcloud/server/issues/25436\nnextcloud ç»´æŠ¤æ¨¡å¼ 1 2 3 cd /var/www/nextcloud sudo -u www-data php occ maintenance:mode --on sudo -u www-data php occ maintenance:mode --off ",
  "wordCount" : "4046",
  "inLanguage": "zh-cn",
  "datePublished": "2022-12-20T11:05:07+08:00",
  "dateModified": "2022-12-20T11:05:07+08:00",
  "author":{
    "@type": "Person",
    "name": "hey"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://fivekernels.github.io/posts/nextcloud-with-docker/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "èƒ¡å†™ä¹±ç”»",
    "logo": {
      "@type": "ImageObject",
      "url": "https://fivekernels.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://fivekernels.github.io" accesskey="h" title="èƒ¡å†™ä¹±ç”» (Alt + H)">èƒ¡å†™ä¹±ç”»</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://fivekernels.github.io/" title="ğŸ é¦–é¡µ">
                    <span>ğŸ é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://fivekernels.github.io/posts/" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://fivekernels.github.io/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://fivekernels.github.io/categories/" title="ğŸ§©åˆ†ç±»">
                    <span>ğŸ§©åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://fivekernels.github.io/tags/" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://fivekernels.github.io/about/" title="ğŸ¥£å…³äº">
                    <span>ğŸ¥£å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://fivekernels.github.io/search/" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://fivekernels.github.io">Home</a>&nbsp;Â»&nbsp;<a href="https://fivekernels.github.io/posts/">ğŸ“šæ–‡ç« </a></div>
    <h1 class="post-title">
      Nextcloud With Docker<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>
    </h1>
    <div class="post-meta">



<span title='2022-12-20 11:05:07 +0800 CST'>2022/12/20</span>&nbsp;Â·&nbsp;Updated:&nbsp;2022/12/20&nbsp;Â·&nbsp;9 min&nbsp;Â·&nbsp;4046 words&nbsp;Â·&nbsp;hey

</div>
  </header> 
  <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#docker-compose" aria-label="docker-compose">docker-compose</a><ul>
                            
                    <li>
                        <a href="#docker-composeyml" aria-label="docker-compose.yml">docker-compose.yml</a></li>
                    <li>
                        <a href="#nextcloudenv" aria-label="nextcloud.env">nextcloud.env</a></li>
                    <li>
                        <a href="#mariadbenv" aria-label="mariadb.env">mariadb.env</a></li></ul>
                    </li>
                    <li>
                        <a href="#docker-compose%e6%96%87%e4%bb%b6%e8%a7%a3%e6%9e%90" aria-label="docker-composeæ–‡ä»¶è§£æ">docker-composeæ–‡ä»¶è§£æ</a><ul>
                            
                    <li>
                        <a href="#nextcloud-fpm" aria-label="nextcloud-fpm">nextcloud-fpm</a></li>
                    <li>
                        <a href="#mariadb" aria-label="mariadb">mariadb</a></li>
                    <li>
                        <a href="#nginx" aria-label="nginx">nginx</a></li>
                    <li>
                        <a href="#redis" aria-label="redis">redis</a></li>
                    <li>
                        <a href="#cron" aria-label="cron">cron</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%9b%b4%e6%96%b0nextcloud%e7%89%88%e6%9c%ac" aria-label="æ›´æ–°nextcloudç‰ˆæœ¬">æ›´æ–°nextcloudç‰ˆæœ¬</a></li>
                    <li>
                        <a href="#nextcloud-%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" aria-label="nextcloud é…ç½®æ–‡ä»¶">nextcloud é…ç½®æ–‡ä»¶</a></li>
                    <li>
                        <a href="#nginx-%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" aria-label="nginx é…ç½®æ–‡ä»¶">nginx é…ç½®æ–‡ä»¶</a><ul>
                            
                    <li>
                        <a href="#nginxconf" aria-label="nginx.conf">nginx.conf</a></li></ul>
                    </li>
                    <li>
                        <a href="#mariadb-106%e5%85%bc%e5%ae%b9%e6%80%a7%e9%97%ae%e9%a2%98" aria-label="MariaDB 10.6å…¼å®¹æ€§é—®é¢˜"><del>MariaDB 10.6å…¼å®¹æ€§é—®é¢˜</del></a></li>
                    <li>
                        <a href="#nextcloud-%e7%bb%b4%e6%8a%a4%e6%a8%a1%e5%bc%8f" aria-label="nextcloud ç»´æŠ¤æ¨¡å¼">nextcloud ç»´æŠ¤æ¨¡å¼</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><p>â€ƒâ€ƒæœ¬æ–‡ä»‹ç»äº†åœ¨æ ‘è“æ´¾(aarch64)ä¸Šä½¿ç”¨dockerçš„æ–¹å¼é…ç½®nextcloud:fpmã€mariadbã€nginxã€redisä»¥åŠonlyofficeã€‚</p>
<p>â€ƒâ€ƒNextcloudå®˜æ–¹æ‰‹å†Œä¸­æœ‰æ•°æ®åº“ç­‰å„ç§é•œåƒç‰ˆæœ¬æ¨è<a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/system_requirements.html">https://docs.nextcloud.com/server/latest/admin_manual/installation/system_requirements.html</a>ï¼Œæœ€å¥½ä¸è¦ä½¿ç”¨è¿‡äºæ–°çš„ç‰ˆæœ¬ä»¥å…å‡ºç°æœªè¢«è§£å†³çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p>
<p><strong>Nextcloudç‰ˆæœ¬ä»‹ç»ï¼š</strong></p>
<ul>
<li>nextcloud:latestï¼šé»˜è®¤æœ€æ–°ç‰ˆæœ¬ï¼Œæ–°æ‰‹å‹å¥½ã€‚ä½¿ç”¨debianå®¹å™¨æ­å»ºï¼Œè‡ªå¸¦apache webæœåŠ¡ï¼Œç‰¹ç‚¹å°±æ˜¯ç®€å•æ–¹ä¾¿ï¼Œä¸€é”®éƒ¨ç½²å°±å¯ä»¥ä½¿ç”¨ï¼Œç¼ºç‚¹å°±æ˜¯åŒ…ç•¥å¤§ã€‚</li>
<li>nextcloud:fpmï¼šåœ¨debianå®¹å™¨çš„åŸºç¡€ä¸Šä¸å¸¦apache webæœåŠ¡ï¼Œéœ€è¦é…å¥—webç¨‹åºæ‰èƒ½ä½¿ç”¨ï¼Œå¦‚NGINXã€‚</li>
<li>nextcloud:&lt;version&gt;-alpineï¼šä½¿ç”¨alpineä½œä¸ºå®¹å™¨ï¼Œç©ºé—´å æ®å°‘ï¼Œé€‚åˆå°ä¸»æœºä½¿ç”¨ã€‚</li>
</ul>
<h2 id="docker-compose">docker-compose<a hidden class="anchor" aria-hidden="true" href="#docker-compose">#</a></h2>
<h3 id="docker-composeyml">docker-compose.yml<a hidden class="anchor" aria-hidden="true" href="#docker-composeyml">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">nextcloud</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostname</span>: <span style="color:#ae81ff">nextcloud</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nextcloud:fpm</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nextcloud_nextcloud</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">unless-stopped</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./PersistentData/nextcloud:/var/www/html</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">env_file</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./nextcloud.env</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">redis</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mariadb</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostname</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nextcloud_mariadb</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">unless-stopped</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">command</span>: --<span style="color:#ae81ff">character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --transaction-isolation=READ-COMMITTED --binlog-format=ROW  --innodb_read_only_compressed=OFF</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./PersistentData/mariadb:/var/lib/mysql</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">env_file</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./mariadb.env</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">nginx</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostname</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nextcloud_nginx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">unless-stopped</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./config/nginx/nginx.conf:/etc/nginx/nginx.conf:ro</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span>            - <span style="color:#ae81ff">./config/ssl/&lt;example.domain&gt;/fullchain.pem:/etc/ssl/nginx/fullchain.pem</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span>            - <span style="color:#ae81ff">./config/ssl/&lt;example.domain&gt;/privkey.pem:/etc/ssl/nginx/privkey.pem</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./PersistentData/nextcloud:/usr/share/nginx/html/nextcloud:ro</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#e6db74">&#34;80:80&#34;</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#e6db74">&#34;443:443&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">nextcloud</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">redis</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">redis</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nextcloud_redis</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">unless-stopped</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cron</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nextcloud:fpm</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nextcloud_cron</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">unless-stopped</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./PersistentData/nextcloud:/var/www/html</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">entrypoint</span>: <span style="color:#ae81ff">/cron.sh</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">redis</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nextcloudenv">nextcloud.env<a hidden class="anchor" aria-hidden="true" href="#nextcloudenv">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-txt" data-lang="txt"><span style="display:flex; background-color:#3c3d38"><span>NEXTCLOUD_ADMIN_USER=&lt;nextcloud_admin_user_to_be_created&gt;
</span></span><span style="display:flex; background-color:#3c3d38"><span>NEXTCLOUD_ADMIN_PASSWORD=&lt;nextcloud_admin_user_password_to_be_created&gt;
</span></span><span style="display:flex; background-color:#3c3d38"><span>NEXTCLOUD_TRUSTED_DOMAINS=&lt;example.domain&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MYSQL_HOST=mariadb
</span></span><span style="display:flex; background-color:#3c3d38"><span>MYSQL_DATABASE=&lt;nextcloud_database_to_be_used&gt;
</span></span><span style="display:flex; background-color:#3c3d38"><span>MYSQL_USER=&lt;nextcloud_database_user_to_be_used&gt;
</span></span><span style="display:flex; background-color:#3c3d38"><span>MYSQL_PASSWORD=&lt;nextcloud_database_user_password_to_be_used&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>REDIS_HOST=redis
</span></span><span style="display:flex;"><span>REDIS_HOST_PORT=6379
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mariadbenv">mariadb.env<a hidden class="anchor" aria-hidden="true" href="#mariadbenv">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-txt" data-lang="txt"><span style="display:flex; background-color:#3c3d38"><span>MARIADB_ROOT_PASSWORD=&lt;root_password&gt;
</span></span><span style="display:flex; background-color:#3c3d38"><span>MARIADB_DATABASE=&lt;nextcloud_database_to_be_created&gt;
</span></span><span style="display:flex; background-color:#3c3d38"><span>MARIADB_USER=&lt;nextcloud_database_user_to_be_created&gt;
</span></span><span style="display:flex; background-color:#3c3d38"><span>MARIADB_PASSWORD=&lt;nextcloud_database_user_password_to_be_created&gt;
</span></span><span style="display:flex;"><span>MARIADB_AUTO_UPGRADE=1
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="docker-composeæ–‡ä»¶è§£æ">docker-composeæ–‡ä»¶è§£æ<a hidden class="anchor" aria-hidden="true" href="#docker-composeæ–‡ä»¶è§£æ">#</a></h2>
<p>â€ƒâ€ƒåœ¨Nextcloudçš„å®˜æ–¹dockeré¡µé¢<a href="https://hub.docker.com/_/nextcloud">https://hub.docker.com/_/nextcloud</a> æœ‰docker-composeçš„ç¤ºä¾‹é…ç½®æ–‡ä»¶</p>
<h3 id="nextcloud-fpm">nextcloud-fpm<a hidden class="anchor" aria-hidden="true" href="#nextcloud-fpm">#</a></h3>
<p>â€ƒâ€ƒNextcloudä¸­æ‰€æœ‰çš„æ•°æ®æ–‡ä»¶å­˜æ”¾åœ¨å®¹å™¨å†…çš„/var/www/htmlä¸­ï¼Œå¯ä»¥å°†å…¶æ˜ å°„åˆ°å¤–éƒ¨å­˜å‚¨ã€‚dataå’Œconfigæ–‡ä»¶å­˜å‚¨åœ¨å…¶ä¸­å•ç‹¬çš„æ–‡ä»¶å¤¹ï¼Œappsæ–‡ä»¶å¤¹æ˜¯éšç€nextcloudä¸€èµ·æä¾›çš„ï¼Œæ— éœ€åœ¨æ„ã€‚</p>
<p>â€ƒâ€ƒä½¿ç”¨ç¯å¢ƒå˜é‡å¯ä»¥ç¬¬ä¸€æ¬¡å®‰è£…æ—¶è‡ªåŠ¨é…ç½®ç›¸å…³è®¾ç½®ï¼Œä»¥ä½¿ç”¨MariaDB/MYSQLä¸ºä¾‹ï¼Œé…ç½®æ•°æ®åº“éœ€è¦è®¾ç½®ä»¥ä¸‹å‡ ä¸ªç¯å¢ƒå˜é‡ï¼š</p>
<ul>
<li>MYSQL_HOST: Hostname of the database server using mysql / mariadb.</li>
<li>MYSQL_DATABASE: Name of the database using mysql / mariadb.</li>
<li>MYSQL_USER: Username for the database using mysql / mariadb.</li>
<li>MYSQL_PASSWORD: Password for the database user using mysql / mariadb.</li>
</ul>
<p>â€ƒâ€ƒè®¾ç½®å¦‚ä¸‹ç¯å¢ƒå˜é‡å¯ä»¥åœ¨å®‰è£…nextcloudæ—¶è‡ªåŠ¨é…ç½®ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<ul>
<li>NEXTCLOUD_ADMIN_USER: Name of the Nextcloud admin user.</li>
<li>NEXTCLOUD_ADMIN_PASSWORD: Password for the Nextcloud admin user.</li>
</ul>
<p>â€ƒâ€ƒè®¾ç½®å¦‚ä¸‹ç¯å¢ƒå˜é‡å¯ä»¥åœ¨å®‰è£…æ—¶è‡ªåŠ¨æ·»åŠ å¯ä¿¡åŸŸåï¼š</p>
<ul>
<li>NEXTCLOUD_TRUSTED_DOMAINS: (not set by default) Optional space-separated list of domains</li>
</ul>
<p>â€ƒâ€ƒå¦‚æœä½¿ç”¨äº†redisï¼ˆæ¨èï¼‰ï¼Œè¿˜åº”æ·»åŠ ä¸‹åˆ—å˜é‡æŒ‡å‡ºredisæœåŠ¡å™¨ä¿¡æ¯ï¼š</p>
<ul>
<li>REDIS_HOST (not set by default) Name of Redis container</li>
<li>REDIS_HOST_PORT (default: 6379) Optional port for Redis, only use for external Redis servers that run on non-standard ports.</li>
<li>REDIS_HOST_PASSWORD (not set by default) Redis password</li>
</ul>
<p>â€ƒâ€ƒPHPç›¸å…³é™åˆ¶ï¼šï¼ˆæœªæµ‹è¯•ï¼‰</p>
<ul>
<li>PHP_MEMORY_LIMIT: (default 512M) This sets the maximum amount of memory in bytes that a script is allowed to allocate. This is meant to help prevent poorly written scripts from eating up all available memory but it can prevent normal operation if set too tight.</li>
<li>PHP_UPLOAD_LIMIT: (default 512M) This sets the upload limit (<em>post_max_size</em> and <em>upload_max_filesize</em>) for big files. Note that you may have to change other limits depending on your client, webserver or operating system. Check the <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_files/big_file_upload_configuration.html">Nextcloud documentation</a> for more information.</li>
</ul>
<p>â€ƒâ€ƒå½“ç„¶ï¼Œå¯ä»¥ä½¿ç”¨_FILEæ›¿ä»£ç›´æ¥åœ¨docke-composeè®¾ç½®ç¯å¢ƒå˜é‡ä»¥ä¼ é€’æ•æ„Ÿä¿¡æ¯ã€‚æˆ‘æ²¡ä»”ç»†çœ‹<a href="https://hub.docker.com/_/nextcloud">https://hub.docker.com/_/nextcloud</a></p>
<h3 id="mariadb">mariadb<a hidden class="anchor" aria-hidden="true" href="#mariadb">#</a></h3>
<p>â€ƒâ€ƒmariadbçš„æ•°æ®åº“æ–‡ä»¶ä½äºå®¹å™¨å†…çš„/var/lib/mysqlï¼Œå¯ä»¥å°†å…¶æ˜ å°„åˆ°å®¹å™¨å¤–éƒ¨ã€‚</p>
<p>â€ƒâ€ƒå½“ä½¿ç”¨dockeråˆ›å»ºæ–°æ•°æ®åº“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç¯å¢ƒå˜é‡æ¥è°ƒæ•´MariaDBçš„åˆå§‹åŒ–ï¼Œä»10.5.10å’Œ10.6å¼€å§‹ä»¥åçš„æ‰€æœ‰ç‰ˆæœ¬ä¸­ï¼ŒMARIADB_* å’Œ MYSQL_* å…·æœ‰ç­‰æ•ˆçš„åŠŸèƒ½ï¼Œä¸”MARIADB_*å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚</p>
<p>â€ƒâ€ƒä¸‹åˆ—å››ä¸ªç¯å¢ƒå˜é‡(or equivalents, including *_FILE)å¿…é¡»è®¾å®šä¸€ä¸ªï¼Œä»¥ç¡®å®šroogç”¨æˆ·å¯†ç ï¼š</p>
<ul>
<li>MARIADB_ROOT_PASSWORD: This specifies the password that will be set for the MariaDB root superuser account.</li>
<li>MARIADB_ROOT_PASSWORD_HASH: In order to have no plaintext secret in the deployment, MARIADB_ROOT_PASSWORD_HASH can be used as it is just the hash of the password. The hash can be generated with SELECT PASSWORD(&rsquo;thepassword&rsquo;) as a SQL query.</li>
<li>MARIADB_RANDOM_ROOT_PASSWORD: Set to a non-empty value, like yes, to generate a random initial password for the root user. The generated root password will be printed to stdout (GENERATED ROOT PASSWORD: &hellip;..).</li>
<li>MARIADB_ALLOW_EMPTY_ROOT_PASSWORD: Set to a non-empty value, like yes, to allow the container to be started with a blank password for the root user.</li>
</ul>
<p>â€ƒâ€ƒå…¶ä»–çš„ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰ï¼š</p>
<ul>
<li>MARIADB_DATABASE: This variable allows you to specify the name of a database to be created on image startup.</li>
<li>MARIADB_USER: These are used in conjunction to create a new user and to set that user&rsquo;s password. This user will be granted all access (corresponding to GRANT ALL) to the MARIADB_DATABASE database.</li>
<li>MARIADB_PASSWORD: Both user and password variables are required for a user to be created.</li>
<li>MARIADB_PASSWORD_HASH: See MARIADB_ROOT_PASSWORD_HASH above for how to get a password hash for MARIADB_PASSWORD_HASH.</li>
<li>MARIADB_AUTO_UPGRADE: Set MARIADB_AUTO_UPGRADE to a non-empty value to have the entrypoint check whether mysql_upgrade/mariadb-upgrade needs to run, and if so, run the upgrade before starting the MariaDB server.</li>
<li>MARIADB_DISABLE_UPGRADE_BACKUP: Before the upgrade, a backup of the system database is created in the top of the datadir with the name system_mysql_backup_*.sql.zst. This backup process can be disabled with by setting MARIADB_DISABLE_UPGRADE_BACKUP to a non-empty value.</li>
</ul>
<h3 id="nginx">nginx<a hidden class="anchor" aria-hidden="true" href="#nginx">#</a></h3>
<p>â€ƒâ€ƒç¼–å†™é…ç½®æ–‡ä»¶nginx.confå¹¶æ˜ å°„åˆ°å®¹å™¨å†…çš„/etc/nginx/nginx.confï¼Œä½œä¸ºé…ç½®æ–‡ä»¶ï¼›åŒæ—¶è¿˜éœ€è¦æŠŠnextcloudä¸­çš„/var/www/htmlæ˜ å°„åˆ°nginxå®¹å™¨å†…éƒ¨ï¼Œä½œä¸ºç½‘ç«™å†…å®¹ã€‚</p>
<h3 id="redis">redis<a hidden class="anchor" aria-hidden="true" href="#redis">#</a></h3>
<h3 id="cron">cron<a hidden class="anchor" aria-hidden="true" href="#cron">#</a></h3>
<p>â€ƒâ€ƒå®˜æ–¹æ–‡æ¡£ä¸­å…³äºbackground jonsçš„ä»‹ç»ï¼š<a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/background_jobs_configuration.html">https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/background_jobs_configuration.html</a></p>
<p>â€ƒâ€ƒä½¿ç”¨dockeréƒ¨ç½²cronæ—¶ï¼Œ<a href="https://github.com/nextcloud/docker/issues/1695#issuecomment-1043169925">cronçš„è¿è¡Œéœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨å¹¶å’Œnextcloudå…±äº«æ•°æ®æ–‡ä»¶ï¼Œå¹¶ä¸”æ®è¯´æ‰€å ç”¨çš„å†…å­˜å¾ˆå°‘ï¼Œä¸ä¼šä¸ºä¸»æœºå¸¦æ¥æ€§èƒ½é—®é¢˜</a>ï¼›å¯ä»¥å‚è€ƒå®˜æ–¹ç¤ºä¾‹ä¸­ä½¿ç”¨docker-composeè¿è¡Œcronçš„é…ç½®æ–‡ä»¶ï¼š<a href="https://github.com/nextcloud/docker/blob/master/.examples/docker-compose/insecure/mariadb/apache/docker-compose.yml">https://github.com/nextcloud/docker/blob/master/.examples/docker-compose/insecure/mariadb/apache/docker-compose.yml</a>ã€‚</p>
<p>â€ƒâ€ƒæ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸»æœºçš„cronå¹¶æ­é…docker execå‘½ä»¤å®ç°å®šæ—¶çš„åå°ä»»åŠ¡ã€‚</p>
<h2 id="æ›´æ–°nextcloudç‰ˆæœ¬">æ›´æ–°nextcloudç‰ˆæœ¬<a hidden class="anchor" aria-hidden="true" href="#æ›´æ–°nextcloudç‰ˆæœ¬">#</a></h2>
<p>â€ƒâ€ƒå½“ä½¿ç”¨ docker-compose æ—¶ï¼Œæ›´æ–°å®¹å™¨çš„æ–°ç‰ˆæœ¬åªéœ€è¦è¿è¡Œ:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose pull
</span></span><span style="display:flex;"><span>docker-compose up -d
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€ƒâ€ƒä½†æ˜¯ä¸èƒ½è·¨è¶Šå¤šä¸ªå¤§ç‰ˆæœ¬å‡çº§ï¼Œæ­¤æ—¶éœ€è¦ä¿®æ”¹nextcloud:&lt;version&gt;-fpmæŒ‡å®šå¤§ç‰ˆæœ¬å·è¿›è¡Œä»¥æ­¤å‡çº§ã€‚</p>
<h2 id="nextcloud-é…ç½®æ–‡ä»¶">nextcloud é…ç½®æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#nextcloud-é…ç½®æ–‡ä»¶">#</a></h2>
<p>â€ƒâ€ƒnextcloud æ”¯æŒä½¿ç”¨å¤šä¸ªconfig.phpé…ç½®æ–‡ä»¶ï¼›å¯ä»¥åœ¨/var/www/html/config/è·¯å¾„ä¸‹æ”¾ç½®*.config.phpæ–‡ä»¶å®ç°å¯¹nextcloudçš„é…ç½®ï¼Œä¸”è¿™äº›æ–‡ä»¶ä¸­é…ç½®çš„å‚æ•°ä¼˜å…ˆçº§é«˜äºconfig.phpä¸­çš„è®¾å®šã€‚</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>$CONFIG <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;remember_login_cookie_lifetime&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;default_phone_region&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;CN&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;defaultapp&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;calendar,files,dashboard&#39;</span>,
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€ƒâ€ƒ<em><strong>remember_login_cookie_lifetime</strong></em> è®°ä½ç™»å½• cookie çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸º0åˆ™å…³é—­æµè§ˆå™¨åcookieç«‹å³å¤±æ•ˆã€‚<br>
â€ƒâ€ƒ<em><strong>default_phone_region</strong></em> ä½¿ç”¨ ISO 3166-1 å›½å®¶ä»£ç ä¸º Nextcloud æœåŠ¡å™¨ä¸Šçš„ç”µè¯å·ç è®¾ç½®é»˜è®¤åŒºåŸŸã€‚<br>
â€ƒâ€ƒ<em><strong>defaultapp</strong></em> è®¾ç½®ç”¨æˆ·ç™»å½•åé¦–å…ˆè¿›å…¥çš„åº”ç”¨ï¼›å‚æ•°ä¸ºåœ¨ç‚¹å‡»Nextcloudé¡¶éƒ¨çš„â€œåº”ç”¨ç¨‹åºâ€èœå•åï¼Œå¯¹åº”çš„URLåç§°ï¼Œå¦‚ documentsï¼Œcalendarï¼Œgalleryç­‰ã€‚å¯ä»¥ä½¿ç”¨&quot;,&ldquo;åˆ†éš”åº”ç”¨åˆ—è¡¨ã€‚è®¾ç½®å¤šä¸ªåº”ç”¨åç§°æ—¶ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¿›å…¥åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆå¦‚åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªåº”ç”¨æ²¡å¯ç”¨ï¼‰ï¼Œåˆ™ Nextcloud å°†å°è¯•ä½¿ç”¨æˆ·è¿›å…¥ç¬¬äºŒä¸ªåº”ç”¨ç¨‹åºï¼Œä¾æ­¤ç±»æ¨ã€‚å¦‚æœ Nextcloud æ²¡æœ‰æ‰¾åˆ°å·²å¯ç”¨çš„åº”ç”¨ç¨‹åºï¼Œåˆ™é»˜è®¤ä¸ºä»ªè¡¨æ¿åº”ç”¨ç¨‹åºã€‚</p>
<h2 id="nginx-é…ç½®æ–‡ä»¶">nginx é…ç½®æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#nginx-é…ç½®æ–‡ä»¶">#</a></h2>
<h3 id="nginxconf">nginx.conf<a hidden class="anchor" aria-hidden="true" href="#nginxconf">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
</span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">158
</span></span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">159
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">160
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">161
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">162
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">163
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">164
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">165
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">166
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">167
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">168
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">169
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">170
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">171
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">172
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">173
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">174
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">175
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">176
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">177
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">178
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">179
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">180
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">181
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">182
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">183
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">184
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">185
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">186
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">187
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">188
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">189
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">190
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">191
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>worker_processes  auto;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>error_log  <span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>log<span style="color:#f92672">/</span>nginx<span style="color:#f92672">/</span>error.log warn;
</span></span><span style="display:flex;"><span>pid        <span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>nginx.pid;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>events <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>    worker_connections  <span style="color:#ae81ff">1024</span>;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>    include       <span style="color:#f92672">/</span>etc<span style="color:#f92672">/</span>nginx<span style="color:#f92672">/</span>mime.types;
</span></span><span style="display:flex;"><span>    default_type  application<span style="color:#f92672">/</span>octet<span style="color:#f92672">-</span>stream;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    log_format  main  <span style="color:#e6db74">&#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    access_log  <span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>log<span style="color:#f92672">/</span>nginx<span style="color:#f92672">/</span>access.log  main;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sendfile        <span style="color:#66d9ef">on</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#tcp_nopush     on;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    keepalive_timeout  <span style="color:#ae81ff">65</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#gzip  on;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    upstream php<span style="color:#f92672">-</span>handler <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>        server nextcloud:<span style="color:#ae81ff">9000</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    server <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>        listen <span style="color:#ae81ff">80</span>;
</span></span><span style="display:flex;"><span>        listen [::]:<span style="color:#ae81ff">80</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#server_name nextcloud.example.com;
</span></span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#75715e"></span>        server_name <span style="color:#f92672">&lt;</span>example.domain<span style="color:#f92672">&gt;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">301</span> https:<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">$</span>server_name<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    server <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>        listen <span style="color:#ae81ff">443</span> <span style="color:#66d9ef">ssl</span> http2;
</span></span><span style="display:flex;"><span>        listen [::]:<span style="color:#ae81ff">443</span> <span style="color:#66d9ef">ssl</span> http2;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#server_name nextcloud.example.com;
</span></span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#75715e"></span>        server_name <span style="color:#f92672">&lt;</span>example.domain<span style="color:#f92672">&gt;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        error_page <span style="color:#ae81ff">497</span> <span style="color:#f92672">=</span><span style="color:#ae81ff">301</span> https:<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">$</span>http_host<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ssl_certificate     <span style="color:#f92672">/</span>etc<span style="color:#f92672">/</span><span style="color:#66d9ef">ssl</span><span style="color:#f92672">/</span>nginx<span style="color:#f92672">/</span>fullchain.pem;
</span></span><span style="display:flex;"><span>        ssl_certificate_key <span style="color:#f92672">/</span>etc<span style="color:#f92672">/</span><span style="color:#66d9ef">ssl</span><span style="color:#f92672">/</span>nginx<span style="color:#f92672">/</span>privkey.pem;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ssl_protocols             TLSv1 TLSv1.<span style="color:#ae81ff">1</span> TLSv1.<span style="color:#ae81ff">2</span> TLSv1.<span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>        ssl_ciphers               ECDHE<span style="color:#f92672">-</span>RSA<span style="color:#f92672">-</span>AES128<span style="color:#f92672">-</span>GCM<span style="color:#f92672">-</span>SHA256:ECDHE<span style="color:#f92672">-</span>ECDSA<span style="color:#f92672">-</span>AES128<span style="color:#f92672">-</span>GCM<span style="color:#f92672">-</span>SHA256;
</span></span><span style="display:flex;"><span>        ssl_prefer_server_ciphers <span style="color:#66d9ef">on</span>;
</span></span><span style="display:flex;"><span>        ssl_ecdh_curve            secp384r1;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># HSTS settings
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># WARNING: Only add the preload option once you read about
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># the consequences in https://hstspreload.org/. This option
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># will add the domain to a hardcoded list that is shipped
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># in all major browsers and getting removed from this list
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># could take several months.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        add_header Strict<span style="color:#f92672">-</span>Transport<span style="color:#f92672">-</span>Security <span style="color:#e6db74">&#34;max-age=15768000; includeSubDomains; preload;&#34;</span> always;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># set max upload size
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        client_max_body_size <span style="color:#ae81ff">100</span>G;
</span></span><span style="display:flex;"><span>        fastcgi_buffers <span style="color:#ae81ff">64</span> <span style="color:#ae81ff">4</span>K;
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>        fastcgi_send_timeout <span style="color:#ae81ff">300</span>s;
</span></span><span style="display:flex;"><span>        fastcgi_read_timeout <span style="color:#ae81ff">300</span>s; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Enable gzip but do not remove ETag headers
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        gzip <span style="color:#66d9ef">on</span>;
</span></span><span style="display:flex;"><span>        gzip_vary <span style="color:#66d9ef">on</span>;
</span></span><span style="display:flex;"><span>        gzip_comp_level <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>        gzip_min_length <span style="color:#ae81ff">256</span>;
</span></span><span style="display:flex;"><span>        gzip_proxied expired no<span style="color:#f92672">-</span>cache no<span style="color:#f92672">-</span>store private no_last_modified no_etag auth;
</span></span><span style="display:flex;"><span>        gzip_types application<span style="color:#f92672">/</span>atom<span style="color:#f92672">+</span>xml application<span style="color:#f92672">/</span>javascript application<span style="color:#f92672">/</span>json application<span style="color:#f92672">/</span>ld<span style="color:#f92672">+</span>json application<span style="color:#f92672">/</span>manifest<span style="color:#f92672">+</span>json application<span style="color:#f92672">/</span>rss<span style="color:#f92672">+</span>xml application<span style="color:#f92672">/</span>vnd.geo<span style="color:#f92672">+</span>json application<span style="color:#f92672">/</span>vnd.ms<span style="color:#f92672">-</span>fontobject application<span style="color:#f92672">/</span>x<span style="color:#f92672">-</span>font<span style="color:#f92672">-</span>ttf application<span style="color:#f92672">/</span>x<span style="color:#f92672">-</span>web<span style="color:#f92672">-</span>app<span style="color:#f92672">-</span>manifest<span style="color:#f92672">+</span>json application<span style="color:#f92672">/</span>xhtml<span style="color:#f92672">+</span>xml application<span style="color:#f92672">/</span>xml font<span style="color:#f92672">/</span>opentype image<span style="color:#f92672">/</span>bmp image<span style="color:#f92672">/</span>svg<span style="color:#f92672">+</span>xml image<span style="color:#f92672">/</span>x<span style="color:#f92672">-</span>icon <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>cache<span style="color:#f92672">-</span>manifest <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>css <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>plain <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>vcard <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>vnd.rim.location.xloc <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>vtt <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>x<span style="color:#f92672">-</span>component <span style="color:#66d9ef">text</span><span style="color:#f92672">/</span>x<span style="color:#f92672">-</span><span style="color:#66d9ef">cross</span><span style="color:#f92672">-</span>domain<span style="color:#f92672">-</span>policy;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Pagespeed is not supported by Nextcloud, so if your server is built
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># with the `ngx_pagespeed` module, uncomment this line to disable it.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">#pagespeed off;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># HTTP response headers borrowed from Nextcloud `.htaccess`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        add_header Referrer<span style="color:#f92672">-</span>Policy                      <span style="color:#e6db74">&#34;no-referrer&#34;</span>   always;
</span></span><span style="display:flex;"><span>        add_header X<span style="color:#f92672">-</span>Content<span style="color:#f92672">-</span>Type<span style="color:#f92672">-</span>Options               <span style="color:#e6db74">&#34;nosniff&#34;</span>       always;
</span></span><span style="display:flex;"><span>        add_header X<span style="color:#f92672">-</span>Download<span style="color:#f92672">-</span>Options                   <span style="color:#e6db74">&#34;noopen&#34;</span>        always;
</span></span><span style="display:flex;"><span>        add_header X<span style="color:#f92672">-</span>Frame<span style="color:#f92672">-</span>Options                      <span style="color:#e6db74">&#34;SAMEORIGIN&#34;</span>    always;
</span></span><span style="display:flex;"><span>        add_header X<span style="color:#f92672">-</span>Permitted<span style="color:#f92672">-</span><span style="color:#66d9ef">Cross</span><span style="color:#f92672">-</span>Domain<span style="color:#f92672">-</span>Policies    <span style="color:#e6db74">&#34;none&#34;</span>          always;
</span></span><span style="display:flex;"><span>        add_header X<span style="color:#f92672">-</span>Robots<span style="color:#f92672">-</span>Tag                         <span style="color:#e6db74">&#34;none&#34;</span>          always;
</span></span><span style="display:flex;"><span>        add_header X<span style="color:#f92672">-</span>XSS<span style="color:#f92672">-</span>Protection                     <span style="color:#e6db74">&#34;1; mode=block&#34;</span> always;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Remove X-Powered-By, which is an information leak
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        fastcgi_hide_header X<span style="color:#f92672">-</span>Powered<span style="color:#f92672">-</span><span style="color:#66d9ef">By</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Path to the root of your installation
</span></span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#75715e"></span>        root <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span>nginx<span style="color:#f92672">/</span>html<span style="color:#f92672">/</span>nextcloud;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Specify how to handle directories -- specifying `/index.php$request_uri`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># here as the fallback means that Nginx always exhibits the desired behaviour
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># when a client requests a path that corresponds to a directory that exists
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># on the server. In particular, if that directory contains an index.php file,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># that file is correctly served; if it doesn&#39;t, then the request is passed to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># the front-end controller. This consistent behaviour means that we don&#39;t need
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># to specify custom rules for certain paths (e.g. images and other assets,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># `/updater`, `/ocm-provider`, `/ocs-provider`), and thus
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># `try_files $uri $uri/ /index.php$request_uri`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># always provides the desired behaviour.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">index</span> <span style="color:#66d9ef">index</span>.php <span style="color:#66d9ef">index</span>.html <span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Rule borrowed from `.htaccess` to handle Microsoft DAV clients
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        location <span style="color:#f92672">=</span> <span style="color:#f92672">/</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ( <span style="color:#960050;background-color:#1e0010">$</span>http_user_agent <span style="color:#f92672">~</span> <span style="color:#f92672">^</span>DavClnt ) <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">302</span> <span style="color:#f92672">/</span>remote.php<span style="color:#f92672">/</span>webdav<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">$</span>is_args<span style="color:#960050;background-color:#1e0010">$</span>args;
</span></span><span style="display:flex;"><span>            <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        location <span style="color:#f92672">=</span> <span style="color:#f92672">/</span>robots.txt <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            allow <span style="color:#66d9ef">all</span>;
</span></span><span style="display:flex;"><span>            log_not_found off;
</span></span><span style="display:flex;"><span>            access_log off;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Make a regex exception for `/.well-known` so that clients can still
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># access it despite the existence of the regex rule
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># `location ~ /(\.|autotest|...)` which would otherwise handle requests
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># for `/.well-known`.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        location <span style="color:#f92672">^~</span> <span style="color:#f92672">/</span>.well<span style="color:#f92672">-</span>known <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># The rules in this block are an adaptation of the rules
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e"># in `.htaccess` that concern `/.well-known`.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>            location <span style="color:#f92672">=</span> <span style="color:#f92672">/</span>.well<span style="color:#f92672">-</span>known<span style="color:#f92672">/</span>carddav <span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">301</span> <span style="color:#960050;background-color:#1e0010">$</span>scheme:<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">$</span>http_host<span style="color:#f92672">/</span>remote.php<span style="color:#f92672">/</span>dav<span style="color:#f92672">/</span>; <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>            location <span style="color:#f92672">=</span> <span style="color:#f92672">/</span>.well<span style="color:#f92672">-</span>known<span style="color:#f92672">/</span>caldav  <span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">301</span> <span style="color:#960050;background-color:#1e0010">$</span>scheme:<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">$</span>http_host<span style="color:#f92672">/</span>remote.php<span style="color:#f92672">/</span>dav<span style="color:#f92672">/</span>; <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            location <span style="color:#f92672">/</span>.well<span style="color:#f92672">-</span>known<span style="color:#f92672">/</span>acme<span style="color:#f92672">-</span>challenge    <span style="color:#960050;background-color:#1e0010">{</span> try_files <span style="color:#960050;background-color:#1e0010">$</span>uri <span style="color:#960050;background-color:#1e0010">$</span>uri<span style="color:#f92672">/</span> <span style="color:#f92672">=</span><span style="color:#ae81ff">404</span>; <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>            location <span style="color:#f92672">/</span>.well<span style="color:#f92672">-</span>known<span style="color:#f92672">/</span>pki<span style="color:#f92672">-</span>validation    <span style="color:#960050;background-color:#1e0010">{</span> try_files <span style="color:#960050;background-color:#1e0010">$</span>uri <span style="color:#960050;background-color:#1e0010">$</span>uri<span style="color:#f92672">/</span> <span style="color:#f92672">=</span><span style="color:#ae81ff">404</span>; <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Let Nextcloud&#39;s API for `/.well-known` URIs handle all other
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e"># requests by passing them to the front-end controller.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">301</span> <span style="color:#960050;background-color:#1e0010">$</span>scheme:<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">$</span>http_host<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Rules borrowed from `.htaccess` to hide certain paths from clients
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        location <span style="color:#f92672">~</span> <span style="color:#f92672">^/</span>(<span style="color:#f92672">?</span>:build<span style="color:#f92672">|</span>tests<span style="color:#f92672">|</span>config<span style="color:#f92672">|</span>lib<span style="color:#f92672">|</span><span style="color:#ae81ff">3</span>rdparty<span style="color:#f92672">|</span>templates<span style="color:#f92672">|</span>data)(<span style="color:#f92672">?</span>:<span style="color:#960050;background-color:#1e0010">$</span><span style="color:#f92672">|/</span>)  <span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">404</span>; <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>        location <span style="color:#f92672">~</span> <span style="color:#f92672">^/</span>(<span style="color:#f92672">?</span>:<span style="color:#960050;background-color:#1e0010">\</span>.<span style="color:#f92672">|</span>autotest<span style="color:#f92672">|</span>occ<span style="color:#f92672">|</span>issue<span style="color:#f92672">|</span>indie<span style="color:#f92672">|</span>db_<span style="color:#f92672">|</span>console)                <span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">404</span>; <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Ensure this block, which passes PHP files to the PHP process, is above the blocks
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># which handle static assets (as seen below). If this block is not declared first,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># then Nginx will encounter an infinite rewriting loop when it prepends `/index.php`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e"># to the URI, resulting in a HTTP 500 error response.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        location <span style="color:#f92672">~</span> <span style="color:#960050;background-color:#1e0010">\</span>.<span style="color:#a6e22e">php</span>(<span style="color:#f92672">?</span>:<span style="color:#960050;background-color:#1e0010">$</span><span style="color:#f92672">|/</span>) <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            fastcgi_split_path_info <span style="color:#f92672">^</span>(.<span style="color:#f92672">+?</span><span style="color:#960050;background-color:#1e0010">\</span>.php)(<span style="color:#f92672">/</span>.<span style="color:#f92672">*</span>)<span style="color:#960050;background-color:#1e0010">$</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">set</span> <span style="color:#960050;background-color:#1e0010">$</span>path_info <span style="color:#960050;background-color:#1e0010">$</span>fastcgi_path_info;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            try_files <span style="color:#960050;background-color:#1e0010">$</span>fastcgi_script_name <span style="color:#f92672">=</span><span style="color:#ae81ff">404</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            include fastcgi_params;
</span></span><span style="display:flex; background-color:#3c3d38"><span>            <span style="color:#75715e"># fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
</span></span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#75715e"></span>            fastcgi_param SCRIPT_FILENAME <span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>www<span style="color:#f92672">/</span>html<span style="color:#960050;background-color:#1e0010">$</span>fastcgi_script_name;
</span></span><span style="display:flex;"><span>            fastcgi_param PATH_INFO <span style="color:#960050;background-color:#1e0010">$</span>path_info;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#fastcgi_param HTTPS on;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>            fastcgi_param modHeadersAvailable <span style="color:#66d9ef">true</span>;         <span style="color:#75715e"># Avoid sending the security headers twice
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            fastcgi_param front_controller_active <span style="color:#66d9ef">true</span>;     <span style="color:#75715e"># Enable pretty urls
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            fastcgi_pass php<span style="color:#f92672">-</span>handler;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            fastcgi_intercept_errors <span style="color:#66d9ef">on</span>;
</span></span><span style="display:flex;"><span>            fastcgi_request_buffering off;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        location <span style="color:#f92672">~</span> <span style="color:#960050;background-color:#1e0010">\</span>.(<span style="color:#f92672">?</span>:css<span style="color:#f92672">|</span>js<span style="color:#f92672">|</span>svg<span style="color:#f92672">|</span>gif)<span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            try_files <span style="color:#960050;background-color:#1e0010">$</span>uri <span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>            expires <span style="color:#ae81ff">6</span>M;         <span style="color:#75715e"># Cache-Control policy borrowed from `.htaccess`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            access_log off;     <span style="color:#75715e"># Optional: Don&#39;t log access to assets
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        location <span style="color:#f92672">~</span> <span style="color:#960050;background-color:#1e0010">\</span>.woff2<span style="color:#f92672">?</span><span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            try_files <span style="color:#960050;background-color:#1e0010">$</span>uri <span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>            expires <span style="color:#ae81ff">7</span>d;         <span style="color:#75715e"># Cache-Control policy borrowed from `.htaccess`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            access_log off;     <span style="color:#75715e"># Optional: Don&#39;t log access to assets
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Rule borrowed from `.htaccess`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        location <span style="color:#f92672">/</span>remote <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">301</span> <span style="color:#f92672">/</span>remote.php<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        location <span style="color:#f92672">/</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>            try_files <span style="color:#960050;background-color:#1e0010">$</span>uri <span style="color:#960050;background-color:#1e0010">$</span>uri<span style="color:#f92672">/</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#960050;background-color:#1e0010">$</span>request_uri;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€ƒâ€ƒ<em><strong>root /usr/share/nginx/html/nextcloud;</strong></em> è®¾ç½®äº†ç½‘ç«™çš„æ ¹ç›®å½•ä½ç½®ï¼›éœ€è¦é€šè¿‡docker-composeæŠŠnextcloudä¸­çš„/var/www/htmlæ˜ å°„åˆ° <em>root &hellip;</em> è®¾ç½®çš„è·¯å¾„ä¸‹ã€‚</p>
<p>â€ƒâ€ƒ<em><strong>fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name;</strong></em> ç”¨æ¥é…ç½®fastcgiä¼ é€’nginxåˆ°php-fpmçš„ä¿¡æ¯ï¼Œ<em>/var/www/html</em> éœ€è¦è®¾å®šä¸ºnextcloudå®¹å™¨ä¸­ç½‘ç«™çš„è·¯å¾„ï¼›è‹¥nginxä¸­çš„ç½‘ç«™è·¯å¾„ä½¿ç”¨ <em>root &hellip;</em> è®¾å®šä¸ºä¸nextcloudä¸­è·¯å¾„ç›¸åŒ(<em>/var/www/html</em>)ï¼Œåˆ™å¯ä»¥ä½¿ç”¨  <em>$document_root</em> ä»£æ›¿ <em>/var/www/html</em>ã€‚</p>
<h2 id="mariadb-106å…¼å®¹æ€§é—®é¢˜"><del>MariaDB 10.6å…¼å®¹æ€§é—®é¢˜</del><a hidden class="anchor" aria-hidden="true" href="#mariadb-106å…¼å®¹æ€§é—®é¢˜">#</a></h2>
<p>â€ƒâ€ƒnextcloud25å·²æ— æ­¤é—®é¢˜ã€‚<br>
â€ƒâ€ƒnextcloud22å’Œmariadb10.6æœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œå¯¹docker-composeæ–‡ä»¶ä¸­mariadbçš„commandæ·»åŠ &ndash;innodb_read_only_compressed=OFFå¯æš‚æ—¶è§£å†³ã€‚</p>
<p><a href="https://github.com/nextcloud/server/issues/25436">https://github.com/nextcloud/server/issues/25436</a></p>
<h2 id="nextcloud-ç»´æŠ¤æ¨¡å¼">nextcloud ç»´æŠ¤æ¨¡å¼<a hidden class="anchor" aria-hidden="true" href="#nextcloud-ç»´æŠ¤æ¨¡å¼">#</a></h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /var/www/nextcloud
</span></span><span style="display:flex;"><span>sudo -u www-data php occ maintenance:mode --on
</span></span><span style="display:flex;"><span>sudo -u www-data php occ maintenance:mode --off
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://fivekernels.github.io/tags/nextcloud/">nextcloud</a></li>
      <li><a href="https://fivekernels.github.io/tags/docker/">docker</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://fivekernels.github.io/posts/stm32-systick-ll/">
    <span class="title"> Â»</span>
    <br>
    <span>STM32 SysTick LL</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://fivekernels.github.io">èƒ¡å†™ä¹±ç”»</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
